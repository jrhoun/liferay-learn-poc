
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <title>Implementing a Custom Checkout Step &#8212; Liferay Learn</title>
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" /> 
  </head><body>
<svg display="none" height="0" version="1.1" width="0" xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink">
    <symbol id="analytics-cloud-logo" viewBox="0 0 28 28">
        <g transform="translate(-7 -6)" fill="none">
            <rect width="40" height="40" />
            <path
                d="M17.066 20.4c.728 0 1.334.593 1.334 1.304v10.192c0 .711-.606 1.304-1.334 1.304H8.534c-.728 0-1.334-.593-1.334-1.304V21.704c0-.711.606-1.304 1.334-1.304h8.532zM33.066 13.2c.728 0 1.334.57 1.334 1.255v17.49c0 .685-.606 1.255-1.334 1.255h-8.532c-.728 0-1.334-.57-1.334-1.255v-17.49c0-.685.606-1.255 1.334-1.255h8.532z"
                fill="#0791D6" />
            <path
                d="M25.066 6.8c.728 0 1.334.567 1.334 1.248v23.904c0 .68-.606 1.248-1.334 1.248h-8.532c-.727 0-1.334-.567-1.334-1.248V8.048c0-.68.607-1.248 1.334-1.248h8.532z"
                fill="#0B63CE" />
            <path
                d="M15.241 20.4h1.805s1.354-.078 1.354 1.461v10.263s0 1.066-1.6 1.066c0 0-1.354.197-1.6-1.145V20.401h.041zM24.554 13.2s-1.354-.075-1.354 1.407V32.164s0 1.026 1.6 1.026c0 0 1.354.19 1.6-1.102V13.201h-1.846z"
                fill="#0F37A7" />
        </g>
    </symbol>
    <symbol id="commerce-logo" viewBox="0 0 32 32">
        <path
            d="m12.254 5.918 7.337 6.289c.893.815 1.01 2.213.194 3.106l-8.618 10.016a2.118 2.118 0 0 1 -1.453.753 1.739 1.739 0 0 1 -.294.023l-6.561-.078c-.816 0-1.63-.698-1.747-1.514l-1.003-6.203c-.109-.71-.092-1.528.42-2.143l8.619-10.017c.776-.932 2.174-1.01 3.106-.233z"
            fill="#1aa0e8" />
        <path
            d="m19.746 25.173-7.298-6.289a2.172 2.172 0 0 1 -.233-3.106l8.618-10.016c.502-.602 1.167-.762 1.991-.736l6.356.038c.815 0 1.63.698 1.747 1.514l1.048 6.483c.014.099.021.189.02.27a2.275 2.275 0 0 1 -.524 1.593l-8.619 10.016c-.776.932-2.174 1.01-3.106.233z"
            fill="#0b63ce" />
        <path
            d="m17.115 10.084 2.476 2.123c.893.815 1.01 2.213.194 3.106l-4.889 5.681-2.448-2.11a2.172 2.172 0 0 1 -.233-3.106z"
            fill="#134194" />
    </symbol>
    <symbol fill="none" id="community" height="40" width="40">
        <circle opacity=".18" cx="20" cy="20" r="19.5" stroke="#42BFC2" />
        <circle opacity=".15" cx="20" cy="20" r="16" fill="#42BFC2" />
        <path
            d="M26 14.004h1c.55 0 .997.45 1 1v7a1 1 0 0 1-1 1h-2v-5.038a1.962 1.962 0 0 0-1.963-1.962H16v-1a1 1 0 0 1 1-1h5.594l1.7-1.706c.722-.685 1.716-.079 1.706.706v1zM15.525 20.004h5c.7 0 .6 1 0 1h-5c-.7 0-.7-1 0-1zM18.525 22.004h-3c-.7 0-.7 1 0 1h3c.6 0 .7-1 0-1z"
            fill="#42BFC2" />
        <path fill-rule="evenodd" clip-rule="evenodd"
            d="M23 17.004H13a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h1v1c.013.944 1.13 1.303 1.706.706l1.7-1.706H23a1 1 0 0 0 1-1v-7c0-.553-.45-1-1-1zm0 8H13v-7h10v7z"
            fill="#42BFC2" />
    </symbol>
    <symbol id="dxp-logo" viewBox="0 0 32 32">
        <g fill="none" fill-rule="evenodd">
            <path d="M0 0h32v32H0z" />
            <path
                d="M8.62 4.585C12.338-.629 22.675.097 28.25 5.13c10.519 9.476-3.128 32.825-15.913 23.485a13.226 13.226 0 0 1-.953-.725c-4.035-3.491-7.3-8.433-3.853-21.037.226-.861.634-1.587 1.088-2.267z"
                fill="#1aa0e8" />
            <path
                d="M8.62 4.585C19.365.187 32.83 10.751 22.357 22.494c-2.448 2.72-6.257 5.123-10.02 6.12-2.72.726-5.44.68-7.571-.544-5.123-2.856-6.393-13.012-2.448-18.452 1.813-2.449 3.99-4.08 6.302-5.033z"
                fill="#0b63ce" />
            <path
                d="M22.357 22.494C32.83 10.75 19.365.187 8.62 4.585c-.454.68-.862 1.406-1.088 2.267-3.446 12.604-.182 17.546 3.853 21.037.318.272.635.499.952.725 3.763-.997 7.572-3.4 10.02-6.12z"
                fill="#134194" fill-rule="nonzero" />
        </g>
    </symbol>
    <symbol id="dxp-cloud-logo" viewBox="0 0 32 32">
        <g fill-rule="nonzero" fill="#0B63CE">
            <path
                d="M10.069 3.08C14.55-.418 23.287.65 28.25 5.13c10.227 9.213-2.392 31.543-14.85 24.186 3.674-1.157 7.283-3.513 9.677-6.174l.003-.003c2.735-3.066 3.981-6.143 4.028-9 .048-2.86-1.11-5.382-2.963-7.322C20.854 3.37 15.314 1.702 10.07 3.08z" />
            <path
                d="M12.338 28.614c-.12-.085-.239-.17-.358-.257a9.934 9.934 0 0 1-.595-.468c-3.783-3.273-6.888-7.821-4.422-18.762.164-.73.353-1.487.568-2.274v-.001c.199-.754.536-1.403.921-2.01.055-.086.111-.172.168-.257a13.677 13.677 0 0 1 4.104-.975c9.633-.763 18.797 8.609 9.633 18.884-2.448 2.72-6.256 5.123-10.019 6.12z" />
            <path
                d="M2.318 9.618c1.4-1.89 3.015-3.293 4.743-4.273A7.098 7.098 0 0 0 6.595 6.6c-1.748 6.395-1.829 10.97-.877 14.443.959 3.5 2.933 5.761 5.033 7.578l.003.003c.11.094.22.184.328.268-2.29.405-4.514.213-6.316-.823-5.123-2.856-6.393-13.012-2.448-18.452z" />
        </g>
    </symbol>
    <symbol fill="none" id="github" height="16" width="16">
        <path fill-rule="evenodd" clip-rule="evenodd"
            d="M8.04 0C3.618 0 0 3.618 0 8.04c0 3.537 2.331 6.592 5.467 7.638.402.08.563-.161.563-.402v-1.367c-2.251.482-2.734-1.045-2.734-1.045-.321-.965-.884-1.206-.884-1.206-.724-.483.08-.483.08-.483.804.08 1.206.804 1.206.804.724 1.287 1.93.885 2.332.724.08-.482.24-.884.482-1.045-1.688-.242-3.618-.965-3.618-4.02 0-.885.322-1.608.804-2.17-.08-.242-.321-1.046.08-2.172 0 0 .644-.24 2.171.804.724-.08 1.447-.24 2.09-.24.644 0 1.367.08 2.01.24 1.528-1.045 2.171-.804 2.171-.804.402 1.126.16 1.93.08 2.09.483.563.804 1.287.804 2.171 0 3.056-1.849 3.78-3.698 3.94.322.241.563.723.563 1.527v2.171c0 .241.16.483.563.402 3.216-1.045 5.467-4.1 5.467-7.638C16.079 3.618 12.46 0 8.039 0z"
            fill="#A7A9BC" />
    </symbol>
    <symbol fill="none" id="lrdc" height="40" width="40">
        <circle opacity=".15" cx="20" cy="20" r="19.5" stroke="#0B5FFF" />
        <circle opacity=".15" cx="20" cy="20" r="16" fill="#0B63CE" />
        <path
            d="M20.625 11.24l6.995 5.988a.997.997 0 0 1-.65 1.756.995.995 0 0 1-.649-.24l-.348-.298v7.525a.998.998 0 1 1-1.996 0l.057-9.185-4.057-3.474-3.985 3.418v9.24a.998.998 0 0 1-1.996 0v-7.527l-.348.298a.998.998 0 1 1-1.3-1.515l6.978-5.985a.998.998 0 0 1 1.299-.001z"
            fill="#0053F0" />
        <path
            d="M16.99 21.979a2.997 2.997 0 0 1 2.994-2.995 2.997 2.997 0 0 1 2.994 2.995v3.992a.998.998 0 0 1-1.996 0v-3.992a.999.999 0 0 0-1.996 0c0 1.084.043 3.942.044 3.98a.998.998 0 0 1-.986 1.01h-.012a.998.998 0 0 1-.998-.987l-.003-.18c-.008-.656-.04-2.868-.04-3.823z"
            fill="#0053F0" />
    </symbol>
    <symbol id="liferay-logo" viewBox="0 0 126 42">
        <g fill="none" fill-rule="evenodd" transform="translate(0 4)">
            <path
                d="M0 4.75c0-1.049.852-1.9 1.902-1.9h21.872c1.05 0 1.901.851 1.901 1.9v21.853c0 1.05-.851 1.9-1.901 1.9H1.902c-1.05 0-1.902-.85-1.902-1.9zm3.804 2.376c0-.263.213-.475.475-.475h2.853c.263 0 .476.212.476.475v2.85a.475.475 0 0 1-.476.475H4.28a.475.475 0 0 1-.475-.475zm5.23-.475a.475.475 0 0 0-.476.475v2.85c0 .263.213.475.476.475h2.853a.475.475 0 0 0 .475-.475v-2.85a.475.475 0 0 0-.475-.475zm4.28.475c0-.263.212-.475.475-.475h2.853c.262 0 .475.212.475.475v2.85a.475.475 0 0 1-.475.475h-2.853a.475.475 0 0 1-.476-.475zM4.278 11.4a.475.475 0 0 0-.475.475v2.85c0 .263.213.476.475.476h2.853a.475.475 0 0 0 .476-.475v-2.85a.475.475 0 0 0-.476-.476zm4.28.475c0-.262.212-.475.475-.475h2.853c.262 0 .475.213.475.475v2.85a.475.475 0 0 1-.475.476H9.034a.475.475 0 0 1-.476-.475zm9.984-.475a.475.475 0 0 0-.475.475v2.85c0 .263.213.476.475.476h2.853a.475.475 0 0 0 .476-.475v-2.85a.475.475 0 0 0-.476-.476zm-14.74 5.226c0-.262.214-.475.476-.475h2.853c.263 0 .476.213.476.475v2.85a.475.475 0 0 1-.476.475H4.28a.475.475 0 0 1-.475-.475zm9.986-.475a.475.475 0 0 0-.476.475v2.85c0 .263.213.475.476.475h2.853a.475.475 0 0 0 .475-.475v-2.85a.475.475 0 0 0-.475-.475zm4.279.475c0-.262.213-.475.475-.475h2.853c.263 0 .476.213.476.475v2.85a.475.475 0 0 1-.476.475h-2.853a.475.475 0 0 1-.475-.475zm-9.034 4.276a.475.475 0 0 0-.476.475v2.85c0 .262.213.475.476.475h2.853a.475.475 0 0 0 .475-.475v-2.85a.475.475 0 0 0-.475-.475zm4.28.475c0-.263.212-.475.475-.475h2.853c.262 0 .475.212.475.475v2.85a.475.475 0 0 1-.475.475h-2.853a.475.475 0 0 1-.476-.475zm5.23-.475a.475.475 0 0 0-.476.475v2.85c0 .262.213.475.475.475h2.853a.475.475 0 0 0 .476-.475v-2.85a.475.475 0 0 0-.476-.475z"
                fill="#0b63ce" />
            <g fill="#09101d" fill-rule="nonzero">
                <path
                    d="M46.575 26.232H35.531V3.295c0-.263-.264-.527-.529-.527h-1.19c-.264 0-.529.264-.529.527v24.519c0 .263.265.527.53.527h12.762c.265 0 .53-.264.53-.527v-1.055c0-.264-.265-.527-.53-.527zM51.337 9.557h-1.124c-.265 0-.53.263-.53.527V27.88c0 .264.265.528.53.528h1.124c.264 0 .529-.264.529-.528V10.084c0-.33-.199-.527-.53-.527zM64.761 2.307l.397-.989c.066-.263 0-.527-.264-.659C63.968.264 63.042 0 62.248 0c-1.388 0-2.579.461-3.372 1.45-.794.923-1.257 2.373-1.257 4.218v3.889l-1.984.132c-.264 0-.463.263-.463.527v.923c0 .263.265.527.53.527h1.917v16.213c0 .264.265.528.53.528h1.123c.265 0 .53-.264.53-.528V11.666h3.703c.264 0 .529-.264.529-.527v-1.055c0-.264-.265-.527-.53-.527h-3.703V5.866c0-1.252.199-2.175.596-2.834.396-.593.925-.857 1.785-.857.33 0 .662.066.926.132.33.066.661.198.992.33a.423.423 0 0 0 .397 0c.132-.132.264-.198.264-.33zM72.565 9.095c-1.058 0-2.116.264-3.108.725a7.503 7.503 0 0 0-2.58 1.978c-.727.857-1.388 1.911-1.785 3.097-.463 1.187-.661 2.57-.661 4.087 0 1.516.198 2.9.661 4.086.463 1.186 1.058 2.241 1.852 3.098a8.237 8.237 0 0 0 2.777 1.977c1.058.461 2.182.66 3.373.66 1.389 0 2.579-.199 3.439-.594.86-.395 1.653-.79 2.314-1.186.265-.132.33-.462.199-.66l-.53-.988c-.066-.132-.198-.198-.33-.264-.132 0-.33 0-.397.066a7.722 7.722 0 0 1-2.05 1.12c-.727.264-1.587.396-2.513.396-.992 0-1.852-.198-2.645-.593s-1.455-.923-2.05-1.582c-.595-.659-.992-1.516-1.323-2.439-.264-.79-.397-1.647-.463-2.57H79.31a.576.576 0 0 0 .53-.395c.065-.264.065-.528.065-.725v-.594c0-2.768-.661-4.943-1.917-6.393-1.455-1.582-3.24-2.307-5.423-2.307zm5.026 8.37H66.613c.132-.856.33-1.647.595-2.372.33-.857.794-1.582 1.389-2.175.529-.593 1.124-1.054 1.852-1.318.66-.33 1.388-.461 2.116-.461 1.52 0 2.777.527 3.637 1.647.86 1.055 1.323 2.637 1.389 4.68zM91.875 9.49c-.33-.197-.661-.263-.992-.329-.33-.066-.595-.066-.926-.066-1.19 0-2.314.396-3.24 1.187-.53.461-.992.988-1.455 1.582l-.066-1.78c0-.264-.265-.527-.53-.527h-.991c-.265 0-.53.263-.53.527V27.88c0 .264.265.528.53.528h1.124c.265 0 .53-.264.53-.528V15.62c.66-1.647 1.388-2.768 2.248-3.36.793-.66 1.52-.924 2.248-.924.397 0 .595 0 .727.066.133 0 .397.132.662.198a.423.423 0 0 0 .397 0c.132-.066.264-.198.264-.33l.33-1.054c.067-.33-.065-.593-.33-.725zM107.151 9.557h-1.058a.52.52 0 0 0-.53.527l-.065.791c-.661-.461-1.257-.79-1.852-1.12a7.45 7.45 0 0 0-3.108-.66c-1.19 0-2.248.264-3.307.725a8.68 8.68 0 0 0-2.71 1.978c-.794.857-1.39 1.911-1.853 3.097-.463 1.187-.66 2.57-.66 4.087 0 3.163.727 5.602 2.115 7.25 1.455 1.713 3.373 2.57 5.82 2.57 1.322 0 2.513-.33 3.637-.923a10.647 10.647 0 0 0 1.984-1.384l.066 1.384c0 .264.265.462.53.462h.991c.265 0 .53-.264.53-.527V10.018c0-.263-.265-.461-.53-.461zm-1.653 3.757v10.545a14.477 14.477 0 0 1-2.712 2.11c-.86.46-1.785.724-2.777.724-.926 0-1.786-.198-2.447-.527a4.887 4.887 0 0 1-1.785-1.516c-.463-.66-.86-1.516-1.125-2.439-.264-.922-.396-2.043-.396-3.23 0-1.054.198-2.108.462-3.031.331-.923.794-1.78 1.323-2.505.53-.725 1.19-1.252 1.984-1.647a4.905 4.905 0 0 1 2.38-.593c.86 0 1.72.197 2.514.527.86.263 1.653.857 2.579 1.582zM125.932 9.755c-.132-.132-.264-.198-.396-.198h-1.19a.497.497 0 0 0-.464.33l-4.034 11.665c-.264.725-.529 1.582-.86 2.505-.132.527-.33.988-.462 1.45-.199-.462-.397-.989-.595-1.45a30.922 30.922 0 0 0-.992-2.439l-4.563-11.666a.497.497 0 0 0-.463-.33h-1.257a.601.601 0 0 0-.463.198c-.066.066-.132.33-.066.462l7.34 18.059-.462 1.45c-.463 1.384-1.058 2.57-1.852 3.427-.661.857-1.455 1.252-2.447 1.252-.198 0-.463 0-.661-.066-.265-.065-.463-.131-.661-.197a.423.423 0 0 0-.397 0c-.132.066-.199.197-.265.33l-.33 1.054c-.066.263.066.527.264.593a4.758 4.758 0 0 0 1.918.395c.86 0 1.653-.197 2.315-.593.66-.33 1.256-.857 1.785-1.45.53-.593.926-1.252 1.257-1.977.33-.725.66-1.384.86-2.11l7.141-20.299c.068-.174.106-.29 0-.395zM51.403 2.834H50.08a.662.662 0 0 0-.66.66V4.81c0 .33.264.66.66.66h1.323c.33 0 .661-.264.661-.66V3.493c0-.33-.33-.659-.661-.659z" />
            </g>
        </g>
    </symbol>
    <symbol id="liferay-waffle" viewBox="0 0 24 24">
        <path
            d="M0 1.778C0 .796.796 0 1.778 0h20.444C23.204 0 24 .796 24 1.778v20.444c0 .982-.796 1.778-1.778 1.778H1.778A1.778 1.778 0 0 1 0 22.222V1.778zM3.556 4c0-.245.199-.444.444-.444h2.667c.245 0 .444.199.444.444v2.667a.444.444 0 0 1-.444.444H4a.444.444 0 0 1-.444-.444V4zm4.888-.444A.444.444 0 0 0 8 4v2.667c0 .245.199.444.444.444h2.667a.444.444 0 0 0 .445-.444V4a.444.444 0 0 0-.445-.444H8.444zm4 .444c0-.245.2-.444.445-.444h2.667c.245 0 .444.199.444.444v2.667a.444.444 0 0 1-.444.444h-2.667a.444.444 0 0 1-.445-.444V4zM4 8a.444.444 0 0 0-.444.444v2.667c0 .246.199.445.444.445h2.667a.444.444 0 0 0 .444-.445V8.444A.444.444 0 0 0 6.667 8H4zm4 .444C8 8.2 8.199 8 8.444 8h2.667c.246 0 .445.199.445.444v2.667a.444.444 0 0 1-.445.445H8.444A.444.444 0 0 1 8 11.11V8.444zM17.333 8a.444.444 0 0 0-.444.444v2.667c0 .246.199.445.444.445H20a.444.444 0 0 0 .444-.445V8.444A.444.444 0 0 0 20 8h-2.667zM3.556 12.889c0-.246.199-.445.444-.445h2.667c.245 0 .444.2.444.445v2.667a.444.444 0 0 1-.444.444H4a.444.444 0 0 1-.444-.444v-2.667zm9.333-.445a.444.444 0 0 0-.445.445v2.667c0 .245.2.444.445.444h2.667a.444.444 0 0 0 .444-.444v-2.667a.444.444 0 0 0-.444-.445h-2.667zm4 .445c0-.246.199-.445.444-.445H20c.245 0 .444.2.444.445v2.667A.444.444 0 0 1 20 16h-2.667a.444.444 0 0 1-.444-.444v-2.667zm-8.445 4a.444.444 0 0 0-.444.444V20c0 .245.199.444.444.444h2.667a.444.444 0 0 0 .445-.444v-2.667a.444.444 0 0 0-.445-.444H8.444zm4 .444c0-.245.2-.444.445-.444h2.667c.245 0 .444.199.444.444V20a.444.444 0 0 1-.444.444h-2.667a.444.444 0 0 1-.445-.444v-2.667zm4.89-.444a.444.444 0 0 0-.445.444V20c0 .245.199.444.444.444H20a.444.444 0 0 0 .444-.444v-2.667c0-.245-.2-.443-.444-.443h-2.667l.001-.001z"
            fill="#FFF" fill-rule="evenodd" />
    </symbol>
    <symbol fill="none" id="helpcenter" height="40" width="40">
        <circle opacity=".12" cx="20" cy="20" r="19.5" stroke="#E06E31" />
        <circle opacity=".12" cx="20" cy="20" r="16" fill="#E06E31" />
        <path fill-rule="evenodd" clip-rule="evenodd"
            d="M23.506 14.03c.662 0 1.304.145 1.906.43a4.502 4.502 0 0 1 2.14 5.977c-.91 1.943-6.41 6.864-7.035 7.418a.774.774 0 0 1-.477.195H20a.783.783 0 0 1-.518-.198c-.625-.551-6.124-5.476-7.035-7.418a4.5 4.5 0 0 1 2.14-5.974 4.417 4.417 0 0 1 1.907-.43c1.375 0 2.666.642 3.506 1.698a4.488 4.488 0 0 1 3.506-1.698zM20 26.23c2.346-2.121 5.596-5.288 6.144-6.454a2.937 2.937 0 0 0-1.401-3.903 2.895 2.895 0 0 0-1.24-.279 2.93 2.93 0 0 0-2.643 1.681 2.03 2.03 0 0 0-.107.333.777.777 0 1 1-1.513 0 2.04 2.04 0 0 0-.107-.333 2.927 2.927 0 0 0-2.642-1.68c-.43 0-.848.093-1.241.278a2.942 2.942 0 0 0-1.395 3.903c.548 1.166 3.798 4.333 6.145 6.454z"
            fill="#E06E31" />
    </symbol>
    <symbol fill="none" id="training" height="40" width="40">
        <circle opacity=".15" cx="20" cy="20" r="19.5" stroke="#19AB4F" />
        <circle opacity=".15" cx="20" cy="20" r="16" fill="#19AB4F" />
        <path
            d="M27.958 16.943a.728.728 0 0 0-.686-.488h-4.727l-1.864-4.981a.727.727 0 0 0-1.362 0l-1.864 4.981h-4.728a.727.727 0 0 0-.453 1.297l3.81 3.03-1.75 5.129a.728.728 0 0 0 1.059.86l4.602-2.714 4.733 2.84c.116.07.246.103.374.103h.005c.4-.013.73-.325.73-.727a.718.718 0 0 0-.082-.337l-1.834-5.158 3.804-3.026a.727.727 0 0 0 .233-.809z"
            fill="#287D3C" />
    </symbol>
</svg>

<header role="navigation">
    <div class="brand">
        <a class="company-logo" href="../../../contents.html" title="Home">
            <img src="../../../_static/liferay-waffle.svg" alt="Logo" />
        </a>
        <h2 class="header-title">
            <a href="../../../contents.html">Documentation</a>
        </h2>
    </div>
    <div class="header-links" role="navigation" aria-label="related navigation">
        <a href="www.liferay.com">
            Liferay.com
        </a>
        <a href="">
            Training
        </a>
        <a href="">
            Community
        </a>
        <a href="help.liferay.com">
            Help Center
        </a>
    </div>
</header>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
<div class="container-fluid documentations">
    <div class="row">
        <div class="col-md-12 info-bar">
            <div class="col-md-2 product-version-selector">
            </div>

            <div class="col-md-10 general-info">
                <div class="info">
                    <div class="breadcrumb">
                        breadcrumb
                    </div>

                    <div class="actions">
                        <svg>
                            <use xlink:href="#github"></use>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-2 doc-nav"></div>

        <div class="col-md-7 doc-body offset-md-1"><div class="section" id="implementing-a-custom-checkout-step">
<h1>Implementing a Custom Checkout Step<a class="headerlink" href="#implementing-a-custom-checkout-step" title="永久链接至标题">¶</a></h1>
<p>This tutorial will show you how to add a custom checkout step by implementing the <a class="reference external" href="https://github.com/liferay/com-liferay-commerce/blob/2.0.5/commerce-api/src/main/java/com/liferay/commerce/util/CommerceCheckoutStep.java">CommerceCheckoutStep</a> interface.</p>
<p>A checkout step represents one screen of the checkout process for a customer. Liferay Commerce provides several checkout steps out-of-the-box, including essential steps like <a class="reference external" href="https://github.com/liferay/com-liferay-commerce/blob/2.0.5/commerce-checkout-web/src/main/java/com/liferay/commerce/checkout/web/internal/util/PaymentMethodCommerceCheckoutStep.java">the payment method step</a> and the <a class="reference external" href="https://github.com/liferay/com-liferay-commerce/blob/2.0.5/commerce-checkout-web/src/main/java/com/liferay/commerce/checkout/web/internal/util/OrderConfirmationCommerceCheckoutStep.java">order confirmation step</a>.</p>
<p><img alt="Out-of-the-box checkout steps" src="../../../_images/013.png" /></p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="永久链接至标题">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#deploy-an-example"><strong>Deploy an Example</strong></a></p></li>
<li><p><a class="reference external" href="#walk-through-the-example"><strong>Walk Through the Example</strong></a></p></li>
<li><p><a class="reference external" href="#additional-information"><strong>Additional Information</strong></a></p></li>
</ol>
</div>
<div class="section" id="deploy-an-example">
<h2>Deploy an Example<a class="headerlink" href="#deploy-an-example" title="永久链接至标题">¶</a></h2>
<p>In this section, we will get an example checkout step up and running on your instance of Liferay Commerce. Follow these steps:</p>
<ol>
<li><p>Start Liferay Commerce.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker run -it -p <span class="m">8080</span>:8080 liferay/commerce:2.0.5
</pre></div>
</div>
</li>
<li><p>Download and unzip <a class="reference external" href="#">Acme Commerce Checkout Step</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl liferay-n8n6.zip
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unzip liferay-n8n6.zip
</pre></div>
</div>
</li>
<li><p>Go to <code class="docutils literal notranslate"><span class="pre">liferay-n8n6</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> liferay-n8n6
</pre></div>
</div>
</li>
<li><p>Build and deploy the example.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./gradlew deploy -Ddeploy.docker.container.id<span class="o">=</span><span class="k">$(</span>docker ps -lq<span class="k">)</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Note:</strong> This command is the same as copying the deployed jars to /opt/liferay/osgi/modules on the Docker container.</p>
</div></blockquote>
</li>
<li><p>Confirm the deployment in the Docker container console.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>STARTED com.acme.n8n6.web_1.0.0
</pre></div>
</div>
</li>
<li><p>Verify that the example checkout step was added. Open your browser to <code class="docutils literal notranslate"><span class="pre">https://localhost:8080</span></code> and navigate to a catalog on any Liferay Commerce site. Add an item to the cart, view the cart, and then click “Checkout”. The new “Example Step” will be present in the list of checkout steps.</p></li>
</ol>
<p><img alt="New checkout step" src="../../../_images/023.png" /></p>
<p>Congratulations, you’ve successfully built and deployed a new checkout step that implements <code class="docutils literal notranslate"><span class="pre">CommerceCheckoutStep</span></code>.</p>
<p>Next, let’s dive deeper to learn more.</p>
</div>
<div class="section" id="walk-through-the-example">
<h2>Walk Through the Example<a class="headerlink" href="#walk-through-the-example" title="永久链接至标题">¶</a></h2>
<p>In this section, we will review the example we deployed. First, we will annotate the class for OSGi registration. Second, we will review the <code class="docutils literal notranslate"><span class="pre">CommerceCheckoutStep</span></code> interface. And third, we will complete our implementation of <code class="docutils literal notranslate"><span class="pre">CommerceCheckoutStep</span></code>.</p>
<blockquote>
<div><p><strong>Note:</strong> To simplify implementing <code class="docutils literal notranslate"><span class="pre">CommerceCheckoutStep</span></code>, we extend <code class="docutils literal notranslate"><span class="pre">BaseCommerceCheckoutStep</span></code> for its base functionality.</p>
</div></blockquote>
<div class="section" id="annotate-the-class-for-osgi-registration">
<h3>Annotate the Class for OSGi Registration<a class="headerlink" href="#annotate-the-class-for-osgi-registration" title="永久链接至标题">¶</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Component</span><span class="o">(</span>
    <span class="n">immediate</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
    <span class="n">property</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">&quot;commerce.checkout.step.name=&quot;</span> <span class="o">+</span> <span class="n">N8N6CommerceCheckoutStep</span><span class="o">.</span><span class="na">NAME</span><span class="o">,</span>
        <span class="s">&quot;commerce.checkout.step.order:Integer=21&quot;</span>
    <span class="o">},</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">CommerceCheckoutStep</span><span class="o">.</span><span class="na">class</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">N8N6CommerceCheckoutStep</span> <span class="kd">extends</span> <span class="n">BaseCommerceCheckoutStep</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s">&quot;example-step&quot;</span><span class="o">;</span>
</pre></div>
</div>
<blockquote>
<div><p>The checkout step name must be a unique value so that Liferay Commerce can distinguish our checkout step from existing checkout steps.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">commerce.checkout.step.order</span></code> value indicates how far into the checkout process the checkout step will appear. For example, the <a class="reference external" href="https://github.com/liferay/com-liferay-commerce/blob/2.0.5/commerce-checkout-web/src/main/java/com/liferay/commerce/checkout/web/internal/util/ShippingMethodCommerceCheckoutStep.java">shipping method checkout step</a> has a value of 20. Giving our checkout step a value of 21 ensures that it will appear immediately after the shipping method step.</p>
</div></blockquote>
</div>
<div class="section" id="review-the-commercecheckoutstep-interface">
<h3>Review the <code class="docutils literal notranslate"><span class="pre">CommerceCheckoutStep</span></code> Interface<a class="headerlink" href="#review-the-commercecheckoutstep-interface" title="永久链接至标题">¶</a></h3>
<p>Implement the following methods in addition to extending the base class:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">();</span>
</pre></div>
</div>
<blockquote>
<div><p>This method returns the name of our checkout step. This name may be a language key that corresponds to the name that will appear in the UI.</p>
</div></blockquote>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processAction</span><span class="o">(</span>
        <span class="n">ActionRequest</span> <span class="n">actionRequest</span><span class="o">,</span> <span class="n">ActionResponse</span> <span class="n">actionResponse</span><span class="o">)</span>
    <span class="kd">throws</span> <span class="n">Exception</span><span class="o">;</span>
</pre></div>
</div>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">processAction</span></code> method may be used to implement business logic with the information passed through the <code class="docutils literal notranslate"><span class="pre">ActionRequest</span></code> if backend processing is required.</p>
</div></blockquote>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">render</span><span class="o">(</span>
        <span class="n">HttpServletRequest</span> <span class="n">httpServletRequest</span><span class="o">,</span>
        <span class="n">HttpServletResponse</span> <span class="n">httpServletResponse</span><span class="o">)</span>
    <span class="kd">throws</span> <span class="n">Exception</span><span class="o">;</span>
</pre></div>
</div>
<blockquote>
<div><p>This will be where we add the code to render a customized screen for our checkout step.</p>
</div></blockquote>
</div>
<div class="section" id="complete-the-checkout-step">
<h3>Complete the Checkout Step<a class="headerlink" href="#complete-the-checkout-step" title="永久链接至标题">¶</a></h3>
<p>The checkout step is comprised of a custom screen and backend logic to process any input. Do the following:</p>
<ul class="simple">
<li><p><a class="reference external" href="#configure-the-servletcontext-for-the-module">Configure the <code class="docutils literal notranslate"><span class="pre">ServletContext</span></code> for the module.</a></p></li>
<li><p><a class="reference external" href="#implement-the-render-method">Implement the <code class="docutils literal notranslate"><span class="pre">render</span></code> method.</a></p></li>
<li><p><a class="reference external" href="#add-business-logic-to-processaction">Add business logic to <code class="docutils literal notranslate"><span class="pre">processAction</span></code>.</a></p></li>
<li><p><a class="reference external" href="#add-a-jsp-to-render-the-custom-screen">Add a JSP to render the custom screen.</a></p></li>
<li><p><a class="reference external" href="#add-the-language-key-to-languageproperties">Add the language key to <code class="docutils literal notranslate"><span class="pre">Language.properties</span></code>.</a></p></li>
</ul>
<div class="section" id="configure-the-servletcontext-for-the-module">
<h4>Configure the <code class="docutils literal notranslate"><span class="pre">ServletContext</span></code> for the Module<a class="headerlink" href="#configure-the-servletcontext-for-the-module" title="永久链接至标题">¶</a></h4>
<p>Define the <code class="docutils literal notranslate"><span class="pre">ServletContext</span></code> using the symbolic name of our bundle so that it can find the JSP in our module:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Reference</span><span class="o">(</span><span class="n">target</span> <span class="o">=</span> <span class="s">&quot;(osgi.web.symbolicname=com.acme.n8n6.web)&quot;</span><span class="o">)</span>
<span class="kd">private</span> <span class="n">ServletContext</span> <span class="n">_servletContext</span><span class="o">;</span>
</pre></div>
</div>
<blockquote>
<div><p>The value we set for <code class="docutils literal notranslate"><span class="pre">osgi.web.symbolicname</span></code> matches the value for <code class="docutils literal notranslate"><span class="pre">Bundle-SymbolicName</span></code> in our <a class="reference external" href="./implementing-a-custom-checkout-step/liferay-n8n6.zip/n8n6-web/bnd.bnd">bnd.bnd file</a>. These values must match for the <code class="docutils literal notranslate"><span class="pre">ServletContext</span></code> to locate the JSP.</p>
<p>We also need to declare a unique value for <code class="docutils literal notranslate"><span class="pre">Web-ContextPath</span></code> in our bnd.bnd file so the <code class="docutils literal notranslate"><span class="pre">ServletContext</span></code> is correctly generated. In our example, <code class="docutils literal notranslate"><span class="pre">Web-ContextPath</span></code> is set to <code class="docutils literal notranslate"><span class="pre">/n8n6-web</span></code>. See <a class="reference external" href="./implementing-a-custom-checkout-step/liferay-n8n6.zip/n8n6-web/bnd.bnd">bnd.bnd</a> for a reference on these values.</p>
</div></blockquote>
</div>
<div class="section" id="implement-the-render-method">
<h4>Implement the <code class="docutils literal notranslate"><span class="pre">render</span></code> Method<a class="headerlink" href="#implement-the-render-method" title="永久链接至标题">¶</a></h4>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">render</span><span class="o">(</span>
        <span class="n">HttpServletRequest</span> <span class="n">httpServletRequest</span><span class="o">,</span>
        <span class="n">HttpServletResponse</span> <span class="n">httpServletResponse</span><span class="o">)</span>
    <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

    <span class="n">_jspRenderer</span><span class="o">.</span><span class="na">renderJSP</span><span class="o">(</span>
        <span class="n">_servletContext</span><span class="o">,</span> <span class="n">httpServletRequest</span><span class="o">,</span> <span class="n">httpServletResponse</span><span class="o">,</span>
        <span class="s">&quot;/terms_and_conditions.jsp&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<blockquote>
<div><p>Use a <code class="docutils literal notranslate"><span class="pre">JSPRenderer</span></code> to render the JSP for our checkout step (in this case, <a class="reference external" href="./implementing-a-custom-checkout-step/liferay-n8n6.zip/n8n6-web/src/main/resources/META-INF/resources/terms_and_conditions.jsp">terms_and_conditions.jsp</a>). Provide the <code class="docutils literal notranslate"><span class="pre">ServletContext</span></code> as a parameter to find the JSP we have created.</p>
</div></blockquote>
</div>
<div class="section" id="add-business-logic-to-processaction">
<h4>Add Business Logic to <code class="docutils literal notranslate"><span class="pre">processAction</span></code><a class="headerlink" href="#add-business-logic-to-processaction" title="永久链接至标题">¶</a></h4>
<p>Our example will display text on a custom screen and does not require backend processing in the <code class="docutils literal notranslate"><span class="pre">processAction</span></code> implementation.</p>
</div>
<div class="section" id="add-a-jsp-to-render-the-custom-screen">
<h4>Add a JSP to Render the Custom Screen<a class="headerlink" href="#add-a-jsp-to-render-the-custom-screen" title="永久链接至标题">¶</a></h4>
<p>In our example, we are adding placeholder text. You can see the implementation at <a class="reference external" href="./implementing-a-custom-checkout-step/liferay-n8n6.zip/n8n6-web/src/main/resources/META-INF/resources/terms_and_conditions.jsp">terms_and_conditions.jsp</a>.</p>
</div>
<div class="section" id="add-the-language-key-to-language-properties">
<h4>Add the Language Key to <code class="docutils literal notranslate"><span class="pre">Language.properties</span></code><a class="headerlink" href="#add-the-language-key-to-language-properties" title="永久链接至标题">¶</a></h4>
<p>Add the language key and its value to a <a class="reference external" href="./implementing-a-custom-checkout-step/liferay-n8n6.zip/n8n6-web/src/main/resources/content/Language.properties">Language.properties</a> file within our module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">example</span><span class="o">-</span><span class="n">step</span><span class="o">=</span><span class="n">Example</span> <span class="n">Step</span>
</pre></div>
</div>
<blockquote>
<div><p>See <a class="reference external" href="https://help.liferay.com/hc/en-us/articles/360018168251-Localizing-Your-Application">Localizing Your Application</a> for more information.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="永久链接至标题">¶</a></h2>
<p>Congratulations! You now know the basics for implementing the <code class="docutils literal notranslate"><span class="pre">CommerceCheckoutStep</span></code> interface, and have added a new checkout step to Liferay Commerce.</p>
</div>
<div class="section" id="additional-information">
<h2>Additional Information<a class="headerlink" href="#additional-information" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../user-guide/content/checkout.html"><span class="doc">Checkout</span></a></p></li>
<li><p><a class="reference external" href="https://help.liferay.com/hc/en-us/articles/360018168251-Localizing-Your-Application">Localizing Your Application</a></p></li>
</ul>
</div>
</div>
</div>

        <div class="col-md-2 toc"></div>
    </div>
</div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>